$fc-color: $light-blue !default;
$fc-bracket-width: 32px !default;
$fc-sm-space-y: 1.25rem !default;
$fc-md-space: 4rem !default;
$fc-item-spacing: 1.5rem;
$prototype-border-width: 1px;
$prototype-border-type: dashed;
$prototype-border-color: $fc-color;

@mixin small-item-with-border(){
	margin: $fc-sm-space-y auto;
	content: "";
	display: block;
}

@mixin border-item {
	@include bordered(2px);
	@include small-item-with-border;
}

.flowchart {
	background-color: $dark-blue;
	color: #FFF;

	&.flow-arrow {
		@include template-arrows($border-color: color, $bg-color: $dark-blue);

		&::after {
			background-color: $dark-blue;
		}
	}

	.item {
		text-align: center;

		> * {
			@include template-prop($p: border-color, $key: color, $pref-key: contrast-color);
			@include flex;

			font: 1.75rem / 1em $header-font-family;
			text-transform: uppercase;
			flex-flow: row wrap;
			align-items: center;
			justify-content: center;
			position: relative;
			border: 2px solid $light-blue;
			margin: 0 auto;
			padding: rem-calc(12);

			@include breakpoint(small only){
				padding: rem-calc(10);
			}

			span:first-child {
				flex: 0 0 100%;
				display: inline-block;
			}
		}
	}

	a {
		color: $whiter;

		&, &:hover {
			text-decoration: none;
		}
	}

	h2 {
		text-transform: uppercase;
		font-size: 2.25rem;
		text-align: center;
		padding: 2rem;
		margin: 0;

		&::after {
			@include template-prop($p: border-bottom-color, $key: color);

			content: "";
			display: block;
			width: 4rem;
			margin: .80rem auto 0;
			border-bottom: {
				width: 2px;
				style: solid;
			}
		}
	}

	.bottom a .arrow {
		$arrow-size: 10;
		$border-width: 2;

		display: none;
		border: #{$border-width}px solid #FFF;
		box-sizing: content-box;
		position: absolute;
		top: 2px * $border-width;
		right: 2px * $border-width;
		width: rem-calc($arrow-size);
		height: rem-calc($arrow-size);

		&::before,
		img {
			position: absolute;
			right: rem-calc($border-width * -1);
			top: rem-calc($border-width * -1);
		}

		&::before {
			content: "";
			display: block;
			background: $dark-blue;
			width: rem-calc($arrow-size - 1);
			height: rem-calc($arrow-size - 1);
			z-index: 1;
		}

		img {
			width: rem-calc($arrow-size);
			height: rem-calc($arrow-size);
			z-index: 2;
		}
	}

	@include breakpoint(small only) {
		padding: $fc-sm-space-y * 2 0;
		text-align: center;
		position: relative;

		.item {
			max-width: 500px;
			margin: {
				left: auto;
				right: auto;
			}
		}

		.flowchart-row {
			margin: 0 6%;
		}

		.item > * {
			color: #FFF;
			width: 75%;
			min-width: 252px;
			height: 68px;
			margin-bottom: 0;
			font-size: 1.25rem;
			line-height: 1.2;
		}

		.item ~ .item,
		& + .bottom .item:first-child {
			@include bordered(2px);

			padding-top: $fc-sm-space-y;
			border-width: 2px 0 0;
		}

		.item ~ .item {
			margin: {
				top: $fc-sm-space-y;
				bottom: $fc-sm-space-y;
			}
		}
	}

	@include breakpoint(medium) {
		padding: 50px 0;

		.flowchart-row {
			@include flex;
			flex-wrap: nowrap;
			justify-content: center;
			text-align: center;
			margin: 0 8.5%;
			padding-bottom: $fc-item-spacing;
		}

		.item {
			display: inline-block;
			vertical-align: top;
			padding: 0 $fc-item-spacing / 2;
			width: 280px;
			min-width: 280px;

			& > * {
				font-size: 1.35rem;
				line-height: 1.2;
				height: 100%;
			}

			img {
				max-height: 50px;
			}
		}

		.text {
			padding-top: 1.5rem;
			margin: 0 20%;
		}
	}

	@include breakpoint(medium){
		@include breakpoint(1008px down){
			.item {
				width: 33.33%;
				min-width: 100px;

				& > * {
					font-size: 1.1rem;
				}
			}
		}
	}

	@include breakpoint(1000px down){
		.text {
			margin: 0 10%;
		}
	}

	@include breakpoint(865px down) {
		.flowchart-row {
			margin: {
				left: 5%;
				right: 5%;
			}
		}
	}
}
